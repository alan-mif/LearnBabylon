# *Lesson 4 Light*

### 一、**灯光的作用**

相信从概念上说，灯光的作用并不难想象。因为三维世界里的灯光本身就是对现实世界中的灯光的一种还原，要想知道三维世界里灯光的作用，我们不妨先思考一下现实世界中灯光是如何发挥作用的。

首先说明一下，灯光并不是狭义的单指各种各样的人造灯，而是指一种能发出光的光源，比如现实世界中的太阳就是一种光源。

我们知道一束光从光源位置发出照射到物体上再反射到我们眼中，有这么几个信息是值得我们关注的。

1. 光源位置：决定了光源与物体的相对距离
2. 光的能量：决定了光可以在介质中走多远和光的亮度
3. 光的波长：决定了可见光的颜色
4. 光的发散角度：与光的能量共同决定光能照射到的范围；与光源位置共同决定光与物体的相对角度

好了，以上我们简单分析了现实中光的几种关键属性，明确了哪些属性决定了光的哪些表象。下面我们来看一下 Babylon 中的几种灯光。

### 二、四种灯光类型

- ##### *点光 （Point Light）*

  点光被定义为在 3D 世界中一个点，光从这个点向各个方向发射。可以参考现实中的电灯泡。

  ```
  const light = new BABYLON.PointLight("pointLight", new BABYLON.Vector3(1, 10, 1), scene); // 第二个参数是点光的位置。
  ```

  上面提到的光的波长决定了光的颜色，但是在 3D 世界中我们不必完全严格还原现实世界，这里我们直接给定光的颜色，忽略波长的作用（其他灯光也是如此）。由于点光是向任意方向发散的，所以光源位置基本就决定了光线与物体之间的角度，进而决定了光的入射角与反射角，也就是最终影响到物体的颜色。光的能量决定光能在介质中走多远，可以给定一个距离r，当以点光的位置为球心，r为半径做一个球，点光只在这个范围能起作用，而且光会随着距离球心的距离增加而衰减。

  ```
  light.range = 100; // 点光和聚光灯适用
  ```

  那么如何调整光的亮度呢？同样的，我们无需去做任何复杂的计算，只需要调用babylon的api即可。四种类型灯光皆支持此属性，下面不再赘述。

  ```
  light.intensity = 0.5; // 默认值为1，正常亮度，值越大亮度越高
  ```

- ##### *平行光（Directional Light）*

  平行光由方向定义，光从任意位置发出但方向确定且具有无限的照射范围。可以参考现实里的太阳光，由于太阳距离我们过于遥远，其发出光束可以近似看成平行的。平行光和太阳光还是有一些区别的，因为平行光是从任意位置发出，太阳有相对固定的位置，从而太阳光可能被其他物体遮挡住，而平行光在任意位置发出，所以不会被其他物体遮挡住。

  ```
  const light = new BABYLON.DirectionalLight("DirectionalLight", new BABYLON.Vector3(0, -1, 0), scene); // 第二个参数是平行光的方向
  ```

- ##### *聚光灯（Spot Light）*

  顾名思义，聚光灯还原了现实里的聚光灯，先来想一下现实里聚光灯有什么特性呢？首先，具有一个光源位置，其次有一个照射方向，然后有一个发散的角度，最后由光的能量来决定光能走多远。好，了解了现实中聚光灯的特性以后我们来看一下babylon中聚光灯该如何使用。

  ```
  // 第2个参数是光源位置、第3个参数是照射方向，第4个参数是发散的角度，第5个参数指数exponent
  var light = new BABYLON.SpotLight("spotLight", new BABYLON.Vector3(0, 30, -10), new BABYLON.Vector3(0, -1, 0), Math.PI / 3, 2, scene);
  ```

  这里我们来介绍一下第五个参数exponent，我们知道由于现实里聚光灯的能量有限会形成一个照射范围，这里和点光一样，babylon都是允许直接设置range属性来控制光能照射的范围。而从光源位置到范围的边界，光是不断衰减的，exponent正是用来控制衰减的速度的，当exponent越大时，衰减速度越快。

  

- ##### *半球光（Hemispheric Light）*

  半球光是模拟环境光的简便方法，它由一个方向参数定义，位于世界坐标中心(0,0,0)，一般设置灯光方向朝正上方。那么什么是环境光呢？简单理解，就是指那些由直接光源发出经过周遭环境的漫反射之后的光的集合称为环境光，也就是说环境光的方向是任意的，颜色由直接光源的波长。现在我们忽略现实中复杂的漫反射，直接利用babylon中的半球光来模拟环境光造成的影响。

  ```
  var light = new BABYLON.HemisphericLight("HemiLight", new BABYLON.Vector3(0, 1, 0), scene); // 第2个参数是方向
  ```

好了，到此为止，我们已经介绍完了babylon中的四种灯光。希望同学可以动动手来创建这些灯光，然后改变它们的相关属性并且看看他们分别是什么效果，俗话说，百闻不如一见。这样直接的观察可以更好的理解各种灯光以及他们的作用。那么本节课的内容就到这里了，下节课再见。

